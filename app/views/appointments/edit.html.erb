<h1>Editing appointment</h1>
 
<%= form_for(@appointment, :url => {:controller => 'appointments', :action => 'update'}) do |f| %>
  <% if @appointment.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@appointment.errors.count, "error") %> prohibited this appointment from being saved:</h2>

      <ul>
      <% @appointment.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>
  
  <div class="appointment-table">
	<ul>
  	    <li class="appt-column left">			
			<p>Step 1</p>			
		</li>
		<li class="field appt-field">
				<div>
					<label class="doctor-column">Choose your doctor's office</label>
					<div class="office">
						<%= f.collection_select :office_id, Office.all, :id, :name, :prompt => "Select an office"%><%#= image_tag("ok.png") %>
					</div>
				</div>
	  	</li> 
	</ul>
	<ul>
		<li class="appt-column left">			
			<p>Step 2</p>			
		</li>
		<li class="doctor-field appt-field">
			<div>
				<label class="doctor-column">Select your doctor</label>
				<div class="office"><%= f.collection_select :doctor_id, Doctor.office(@appointment.office_id), :id, :title, :prompt => "Please select a doctor" %>
				</div>
				<!-- <div class="office">
					<%#= f.collection_select :doctor, Doctor.all, :title, :title, :prompt => "Please select a doctor" %>
				</div> -->
			</div>
		</li>
	</ul>

	<ul>
  		<li class="appt-column left">
			<div>
				<p>Step 3</p>
			</div>
		</li>
  		<li class="date-field appt-field">
			<div>
				<label class="doctor-column">Tell us your appointment date</label>
				<div class="office"><%= f.text_field :appt_date, :value => @appointment.appt_date %>
					<%#= f.date_select :appt_date, value: @appointment.appt_date %>
				</div>
				<!-- <div>
					<label class="doctor-column">Appointment Time</label>
					<%#= f.time_select :appt_time, {prompt: true, ampm: true, minute_step: 15, ignore_date: true}, value: @appointment.appt_time %>
				</div> -->
			</div>
  		</li>
	</ul>
	<ul class="margin-bottom">
  		<li class="appt-column left">			
			<p>Step 4</p>			
		</li>
  		<li class="view-form appt-field">
			<ul>
				<li>
					<%= f.fields_for :referral_reason do |referral| %>
						
						<label class="doctor-column">Reason for Visit</label>
						<div class="office referral">
							<%= referral.text_area :visit_reason, value: @appointment.referral_reason.visit_reason %>
						</div>
					<% end %>
				</li>
				<li class="margin-bottom fluid-hide">
					<label class="doctor-column">
						View this office's form
					</label>
					<button class="createButton appt-button" id="appt">View Form</button>
				</li>
				<li class="margin-bottom fluid-hide">
					<%= link_to "Edit Form", edit_user_form_path(current_user.id, current_user.form.id), id: "appt", class: "submit-button appt-button inline-block" %>			
				</li>
				<li class="actions">
					<%= f.submit 'Save Appointment', id: "appt", :class => 'action-button appt-button' %>		  			
		  		</li>				
			</ul>
  		</li>   				
	</ul>
	
  </div>

  <% f.hidden_field :user_id, :value => current_user.id %>
  
  <br /><br />

	<%= render 'appointments/forms/clsma.pdf.html.erb', :user => current_user %>
	 
  <%= render 'appointments/forms/mada.pdf.html.erb', :user => current_user %>

  <%= render 'appointments/forms/mhc.pdf.html.erb', :user => current_user %>

  <%= render 'appointments/forms/sawlani_demographics.pdf.html.erb', user: current_user %>

<% end %>